#! Generated by VisualDCT v2.6
#! DBDSTART
#! DBDEND


record(longout, fgt:gas:active_bottle) {
  field(DESC,"Active Bottle Number")
  field(FLNK, "fgt:gas:pressure1_alarm")
  field(FLNK, "fgt:gas:pressure2_alarm")
  field(FLNK, "fgt:gas:alarm")
}

# records for Adam6017
record(calc, fgt:gas:pressure1) {
  field(INPA, "fgt:gas:1")
  field(CALC, "(A-32767)*3/16")
  field(PREC, "4")
  field(FLNK, "fgt:gas:alarm")
  field(FLNK, "fgt:gas:pressure1_alarm")
  field(LOW,"50")
  field(LOLO,"20")
  field(LSV,"MINOR")
  field(LLSV,"MAJOR")
}
record(calc, fgt:gas:pressure2) {
  field(INPA, "fgt:gas:2")
  field(CALC, "(A-32767)*3/16")
  field(PREC, "4")
  field(FLNK, "fgt:gas:alarm")
  field(FLNK, "fgt:gas:pressure2_alarm")
  field(LOW,"50")
  field(LOLO,"20")
  field(LSV,"MINOR")
  field(LLSV,"MAJOR")
}
record(calc, fgt:gas:pressure3) {
  field(INPA, "fgt:gas:3")
  field(CALC, "(A-32767)*3/1800")
  field(PREC, "4")
  field(FLNK, "fgt:gas:alarm")
  field(HIGH,"20")
  field(HIHI,"25")
  field(LOW,"4")
  field(LOLO,"2")
  field(HSV,"MINOR")
  field(HHSV,"MAJOR")
  field(LSV,"MINOR")
  field(LLSV,"MAJOR")
}

# Major alarm if both gas bottles are < LOLO psi or outout is way out of range (C>HIGH or C<LOLO)
# Minor alarm if both gas bottles are < LOW psi or output < LOW psi
# If "active_bottle" is set to 1 or 2 then always alarm on that bottle
record(calc, fgt:gas:alarm){
  field(INPA, "fgt:gas:pressure1")
  field(INPB, "fgt:gas:pressure2")
  field(INPC, "fgt:gas:pressure3")
  field(INPD, "fgt:gas:pressure1_alarm")
  field(INPE, "fgt:gas:pressure2_alarm")
  field(INPF, "fgt:gas:pressure3.LOLO")
  field(INPI, "fgt:gas:pressure3.LOW")
  field(INPJ, "fgt:gas:pressure3.HIGH")
  field(INPK, "fgt:gas:active_bottle")
  field(CALC, "((D=2)||(E=2)||(C<F)||(C>J))?2:(((D>=1)&&(E>=1))||(C<I))")
  field(PREC, "4")
  field(HIGH,"1")
  field(HSV,"MINOR")
  field(HIHI,"2")
  field(HHSV,"MAJOR")
}

record(calc, fgt:gas:pressure1_alarm){
  field(INPA, "fgt:gas:pressure1")
  field(INPB, "fgt:gas:pressure1.LOLO")
  field(INPC, "fgt:gas:pressure1.LOW")
  field(INPD, "fgt:gas:active_bottle")
  field(CALC, "((A<B)&&(D=1)) ? 2 : ((A<C)||(A<B))")
  field(PREC, "4")
  field(HIGH,"1")
  field(HSV,"MINOR")
  field(HIHI,"2")
  field(HHSV,"MAJOR")
  field(FLNK,"fgt:gas:alarm")
}

record(calc, fgt:gas:pressure2_alarm){
  field(INPA, "fgt:gas:pressure2")
  field(INPB, "fgt:gas:pressure2.LOLO")
  field(INPC, "fgt:gas:pressure2.LOW")
  field(INPD, "fgt:gas:active_bottle")
  field(CALC, "((A<B)&&(D=2)) ? 2 : ((A<C)||(A<B))")
  field(PREC, "4")
  field(HIGH,"1")
  field(HSV,"MINOR")
  field(HIHI,"2")
  field(HHSV,"MAJOR")
  field(FLNK,"fgt:gas:alarm")
}

record(ai, fgt:gas:1) {
  field(DTYP, "asynInt32")
  field(INP, "@asyn(FGTGAS,0,500)MODBUS_DATA")
  field(ESLO, "")
  field(SCAN, "I/O Intr")
  field(FLNK, "fgt:gas:pressure1")
}

record(ai, fgt:gas:2) {
  field(DTYP, "asynInt32")
  field(INP, "@asyn(FGTGAS,1,500)MODBUS_DATA")
  field(ESLO, "")
  field(SCAN, "I/O Intr")
  field(FLNK, "fgt:gas:pressure2")
}

record(ai, fgt:gas:3) {
  field(DTYP, "asynInt32")
  field(INP, "@asyn(FGTGAS,2,500)MODBUS_DATA")
  field(ESLO, "")
  field(SCAN, "I/O Intr")
  field(FLNK, "fgt:gas:pressure3")
}

record(ai, fgt:gas:4) {
  field(DTYP, "asynInt32")
  field(INP, "@asyn(FGTGAS,3,500)MODBUS_DATA")
  field(ESLO, "")
  field(SCAN, "I/O Intr")
}

record(ai, fgt:gas:5) {
  field(DTYP, "asynInt32")
  field(INP, "@asyn(FGTGAS,4,500)MODBUS_DATA")
  field(ESLO, "")
  field(SCAN, "I/O Intr")
}

record(ai, fgt:gas:6) {
  field(DTYP, "asynInt32")
  field(INP, "@asyn(FGTGAS,5,500)MODBUS_DATA")
  field(ESLO, "")
  field(SCAN, "I/O Intr")
}

record(ai, fgt:gas:7) {
  field(DTYP, "asynInt32")
  field(INP, "@asyn(FGTGAS,6,500)MODBUS_DATA")
  field(ESLO, "")
  field(SCAN, "I/O Intr")
}

record(ai, fgt:gas:8) {
  field(DTYP, "asynInt32")
  field(INP, "@asyn(FGTGAS,7,500)MODBUS_DATA")
  field(ESLO, "")
  field(SCAN, "I/O Intr")
}


